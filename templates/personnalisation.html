{% extends "base.html" %}

{% block title %}Personnalisation - Planify{% endblock %}
{% block page_title %}Personnalisation de l'interface{% endblock %}

{% block content %}
<div class="fade-in">
    <div class="max-w-6xl mx-auto">
        <form method="POST" action="{{ url_for('modifier_personnalisation') }}" class="space-y-6">

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-layer-group"></i>
                        Raccourcis essentiels
                    </h3>
                    <p class="text-sm text-gray-600 mt-1">Les données entreprise (coordonnées, logo, légal) sont centralisées dans Paramètres.</p>
                </div>
                <div class="card-body" style="display:flex; justify-content:flex-start; gap:12px; flex-wrap:wrap;">
                    <a href="{{ url_for('parametres') }}#entreprise" class="btn btn-secondary">
                        <i class="fas fa-building"></i>
                        Modifier l'entreprise
                    </a>
                    <a href="{{ url_for('parametres') }}#entreprise" class="btn btn-secondary">
                        <i class="fas fa-palette"></i>
                        Branding & logo
                    </a>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-sliders-h"></i>
                        Identité de l'interface
                    </h3>
                </div>
                <div class="card-body">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="form-group">
                            <label class="form-label" for="terminology_profile">Terminologie</label>
                            <select id="terminology_profile" name="terminology_profile" class="form-control">
                                <option value="missions" {% if parametres.terminology_profile == 'missions' %}selected{% endif %}>Mission / Prestataire / Équipement</option>
                                <option value="prestations" {% if parametres.terminology_profile == 'prestations' %}selected{% endif %}>Prestation / DJ / Matériel</option>
                                <option value="interventions" {% if parametres.terminology_profile == 'interventions' %}selected{% endif %}>Intervention / Intervenant / Matériel</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="ui_theme">Style visuel</label>
                            <select id="ui_theme" name="ui_theme" class="form-control">
                                <option value="classic" {% if parametres.ui_theme == 'classic' %}selected{% endif %}>Classique</option>
                                <option value="soft" {% if parametres.ui_theme == 'soft' %}selected{% endif %}>Doux</option>
                                <option value="contrast" {% if parametres.ui_theme == 'contrast' %}selected{% endif %}>Contrasté</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="ui_density">Densité d'affichage</label>
                            <select id="ui_density" name="ui_density" class="form-control">
                                <option value="comfortable" {% if parametres.ui_density == 'comfortable' %}selected{% endif %}>Confortable</option>
                                <option value="compact" {% if parametres.ui_density == 'compact' %}selected{% endif %}>Compacte</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="ui_font">Police principale</label>
                            <input type="text" id="ui_font" name="ui_font" class="form-control"
                                   value="{{ parametres.ui_font or '' }}"
                                   placeholder="Ex: Sora, Manrope, system-ui">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="ui_radius">Rayon des angles</label>
                            <input type="number" id="ui_radius" name="ui_radius" class="form-control"
                                   min="4" max="28" value="{{ parametres.ui_radius or 14 }}">
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-th-large"></i>
                        Navigation & sections
                    </h3>
                </div>
                <div class="card-body">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                        <label class="flex items-center gap-2">
                            <input type="checkbox" name="show_ai_menu" {% if parametres.show_ai_menu is not none %}{% if parametres.show_ai_menu %}checked{% endif %}{% else %}checked{% endif %}>
                            Afficher le menu IA
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="checkbox" name="show_stats_cards" {% if parametres.show_stats_cards is not none %}{% if parametres.show_stats_cards %}checked{% endif %}{% else %}checked{% endif %}>
                            Statistiques principales (admin)
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="checkbox" name="show_quick_actions" {% if parametres.show_quick_actions is not none %}{% if parametres.show_quick_actions %}checked{% endif %}{% else %}checked{% endif %}>
                            Actions rapides (admin)
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="checkbox" name="show_ai_insights" {% if parametres.show_ai_insights is not none %}{% if parametres.show_ai_insights %}checked{% endif %}{% else %}checked{% endif %}>
                            Insights IA (admin)
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="checkbox" name="show_recent_missions" {% if parametres.show_recent_missions is not none %}{% if parametres.show_recent_missions %}checked{% endif %}{% else %}checked{% endif %}>
                            Missions récentes (admin)
                        </label>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-code"></i>
                        CSS personnalisé
                    </h3>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label class="form-label" for="ui_custom_css">CSS personnalisé</label>
                        <textarea id="ui_custom_css" name="ui_custom_css" class="form-control" rows="4"
                                  placeholder="Ajoutez vos ajustements CSS (ex: .card { box-shadow: none; })">{{ parametres.ui_custom_css or '' }}</textarea>
                        <small class="text-muted">Ces styles s'appliquent immédiatement à toute l'application.</small>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-sliders-h"></i>
                        Champs personnalisés des missions
                    </h3>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label class="form-label" for="custom_fields_prestation">Champs personnalisés (JSON)</label>
                        <textarea id="custom_fields_prestation" name="custom_fields_prestation" class="form-control" rows="5"
                                  placeholder='[{"key":"reference","label":"Référence client","type":"text"},{"key":"priorite","label":"Priorité","type":"select","options":["Basse","Normale","Haute"]}]'>{{ parametres.custom_fields_prestation or '' }}</textarea>
                        <small class="text-muted">Types supportés : text, number, textarea, select, date.</small>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="card">
                <div class="card-body" style="display:flex; justify-content:flex-end; gap:12px;">
                    <a href="{{ url_for('parametres') }}" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left"></i>
                        Paramètres entreprise
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Enregistrer
                    </button>
                </div>
            </div>

        </form>
    </div>
</div>
{% endblock %}
